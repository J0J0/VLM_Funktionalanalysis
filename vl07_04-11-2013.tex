Im Allgemeinen lassen sich konvexe Mengen mit $A\cap B = \emptyset$ nicht
trennen. Es gibt Beispiele mit $A,B$ zusätzlich abgeschlossen, in denen
Trennungen nicht möglich ist. (Siehe Übungen.)

% 4.16
\begin{thKorollar} \label{vl07:korollar4.16}
    Sei $X$ ein normierter Vektorraum und $U\subsetneq X$ ein Unterraum.
    Dann existiert ein $x'\in X'$ mit $x'\neq 0$ und $x'\vert_U = 0$.
\end{thKorollar}

\begin{proof}
    Es sei $x_0\in X$ mit $x_0\notin \setclosure U$. 
    Wende \cref{vl06:hahnbanachgeom2} auf $A=\setclosure U$ und $B=\{x_0\}$ an.
    Wir erhalten somit ein $x'\in X'$ und ein $\alpha\in\R$ mit $\Re x'(x) <
    \alpha < \Re x'(x_0)$ für alle $x\in\setclosure U$. Es folgt für alle
    $\lambda\in\R,\;x\in\setclosure U$:
    \[ \Re x'(\lambda x) < \alpha  . \]
    Also muss schon $\Re x'(x) = 0$ für alle $x\in\setclosure U$ gelten. Wegen
    $\Re x'(x_0) > \Re x'(x) = 0$ für alle $x\in U$ ist außerdem $x'\neq 0$.
    \\
\end{proof}

\nnBemerkung
\cref{vl07:korollar4.16} wird genutzt, um zu zeigen, dass ein Unterraum~$U$
dicht in einem umgebenden Raum~$X$ liegt. Kann man zeigen, dass für alle
$x'\in X'$ aus $x'\vert_U = 0$ schon $x'=0$ folgt, so ergibt sich
$\setclosure U = X$.

% 4.17
\begin{thDef} \label{vl07:def:JX}
    Sei $(X,\emptyNorm)$ ein normierter $\K$-Vektorraum und $X'$ der Dualraum zu~$X$
    \pmycref{vl04:def3.1:dual}.
    Dann ist $X'' \defeq (X')'$ der \emph{Bidualraum von $X$}.
\end{thDef}
    
Wir können auf kanonische Weise eine Abbildung 
$J_X\colon X\to X''$ wie folgt definieren:
\[ x\mapsto \left( 
        \begin{aligned}
            X' &\to \K  \\
            x' &\mapsto x'(x)
        \end{aligned}
    \right)
. \]
Dann ist $J_X$ linear und stetig, denn es gilt für alle $x'\in X'$ und
alle $x\in X$ die Ungleichung
$\abs{x'(x)} \leq \norm{x'}\cdot \norm{x}$ und damit für alle $x\in X$:
\[ \tag{$\ast$} \label{vl07:ast}
    \norm{ J_X(x) } \leq \norm{x}  . \]
Es gilt sogar $\norm{x} = \sup_{x'\in X'} \,\abs{x'(x)}$ für alle $x\in X$.

Sei $x_0\in X\setminus\{0\}$. Setze dann das Funktional
\[ u'\colon \spann\{x_0\} \to \K, \qquad 
    x \mapsto \lambda\,\norm{x_0} 
    \text{\quad falls $\lambda\in\K$ mit $x=\lambda x_0$}
\]
normgleich auf $X$ fort.
Es gilt dann $\norm{x'} = \norm{u'} = 1$ und $x'(x) = \norm{x}$. Damit ist
in \eqref{vl07:ast} sogar Gleichheit gezeigt. Insgesamt folgt:
% 4.18
\begin{thSatz}
    Die Abbildung $J_X$ ist eine (im Allgemeinen nicht surjektive) lineare
    Isometrie, d.\,h. für alle $x\in X$ gilt $\norm{J_X(x)}_{X''} 
    = \norm{x}_X$. (Insbesondere ist $J_X$ als Isometrie stets injektiv.)
\end{thSatz}

% 4.19
\begin{thDef}
    Ein Banachraum~$X$ ist \emph{reflexiv}, wenn $J_X$ surjektiv (also
    bijektiv) ist.
\end{thDef}

\nnBemerkung \label{vl07:bemJX}
Da $J_X$ injektiv ist, kann $X$ mit einem Unterraum von $X''$ identifiziert
werden.

% 4.20
\begin{thDef}
    Sei $X$ ein normierter Raum, $M\subset X$ ein Unterraum und $N\subset X'$
    ein Unterraum des Dualraums.
    Wir definieren dann den \emph{Annihilator von $M$} als
    \begin{align*}
        M^\perp &\defeq \bigl\{ x'\in X' \Mid 
            \forall\,x\in M\colon\; x'(x) = 0\bigr\}
        \\
        &\mathrel{\makebox[\widthof{$\mathsurround=0pt\defeq$}][r]{$\mathsurround=0pt=$}} 
            \bigl\{ x'\in X' \cMid\big x'\vert_M = 0 \bigr\}
        \\
        \intertext{und den \emph{Annihilator von $N$} als}
        %
        N^\perp &\defeq \bigl\{ x\in X \Mid 
        \forall\,x'\in N\colon\; x'(x) = 0 \bigr\}
    . \end{align*}
\end{thDef}

% 4.21
\begin{thBemerkung}\hfill
    \begin{enumerate}[i)]
        \item 
            Es ist $N^\perp$ eine Teilmenge von $X$ und \emph{nicht} 
            von $X''$.
        \item
            Es sind $M^\perp$ und $N^\perp$ abgeschlossene Unterräume.
    \end{enumerate}
\end{thBemerkung}

% 4.22
\begin{thSatz}
    Sei $X$ ein normierter Raum und $M\subset X$ ein Unterraum. Dann gilt
    \[ \bigl(M^\perp\bigr)^\perp = \setclosure M  . \] 
    Sei außerdem $N\subset X'$ ein Unterraum.  Dann gilt 
    \[ \bigl(N^\perp\bigr)^\perp \supset \setclosure N  . \]
    (Im Allgemeinen ist diese Inklusion echt.)
\end{thSatz}

\pagebreak[2]
% 4.23
\begin{thDef}\hfill
    \begin{enumerate}[i)]
        \item
            Es sei $E$ eine Menge und $\phi\colon E\to \neginfinfoc
            = \R \cup \{\infty\}$ eine Abbildung. Wir definieren dann
            \[ D(\phi) \defeq \{ x\in E \Mid \phi(x) < \infty \} 
                = \phi^{-1}(\R)
            . \]
            
        \item
            Der \emph{Epigraph von $\phi$} \pcref{vl07:fig:epigraph} ist die Menge
            \[ \epi(\phi) \defeq
                \{ (x,\lambda) \in E\times\R \Mid \phi(x) \leq \lambda \}
            . \]
            \begin{figure}
                \centering
                \begin{tikzpicture}
                    \draw [->,Daxis] (-0.5,0) -- (6,0);
                    \draw [->,Daxis] (0,-0.3) -- (0,2);
                    
                    \filldraw [fill=black!30, path fading=north, Dfunc]
                        (0.5,2) parabola 
                        bend ($(1,0)!0.5!(5.5,0)+(0,0.4)$) 
                        (5.5,2);
                    
                    \path ($(1,0)!0.5!(5.5,0)$)++(1.4,0.6) node {$\phi$};
                    \path ($(1,0)!0.5!(5.5,0)$)++(0,1.1) node {$\epi(\phi)$};
                \end{tikzpicture}
                \caption{Epigraph einer Funktion $\phi$}
                \label{vl07:fig:epigraph}
            \end{figure}
    \end{enumerate}
\end{thDef}

% 4.24
\begin{thDef}
    Sei $(E,\Topo)$ ein topologischer Raum. Eine Abbildung $\phi\colon E\to
    \neginfinfoc$ ist \emph{unterhalbstetig}, wenn für alle $\lambda\in\R$
    die Menge
    \[ \{ \phi \leq \lambda \} \defeq \{ x\in E \Mid \phi(x) \leq \lambda \}
        = \phi^{-1}(\R[\leq\lambda]) \subset E
    \]
    abgeschlossen ist.
    %
    \begin{figure}[b]
        \centering
        \begin{tikzpicture}
            \draw [->,Daxis] (-1,0) -- (7,0);
            \draw [->,Daxis] (0,-0.5) -- (0,2.5);
            
                \begin{scope}
                    \draw [Dfunc, Cdarkred, arrows={-)}] 
                        (-1,1) .. controls +(0.3,-0.4) and (0.2,0.5) .. (1,0.5);
                    \draw [Dfunc, Cdarkred, arrows={[-}] \SyntaxGobble]
                        (1,1) .. controls +(1,0) .. (3,2.3)
                        node [right] {$\tilde\phi$};
                \end{scope}
            
                \begin{scope}[shift={(4,0)}]
                    \draw [Dfunc, Cdarkgreen, arrows={-]}] 
                        (-1,-0.4) .. controls +(0.3,1) and (0.2,0.5) .. (1,0.5);
                    \draw [Dfunc, Cdarkgreen, arrows={(-}] \SyntaxGobble{)]}
                        (1,1) .. controls +(1,0) and (2,1.8) .. (3,2)
                        node [above] {$\phi$};
                \end{scope}
        \end{tikzpicture}
        \caption{Die Funktion $\color{Cdarkred}\tilde\phi$ ist \emph{nicht} unterhalbstetig,
                 $\color{Cdarkgreen}\phi$ schon}
        \label{vl07:fig:unterhalbstetig}
    \end{figure}
\end{thDef}

% 4.25
\begin{thLemma} \label{vl07:lemma4.25}
    Sei $(E,\Topo)$ ein topologischer Raum und $\phi\colon E\to
    \neginfinfoc$ eine Abbildung. Dann gelten folgende Aussagen:
    \begin{enumerate}[(i)]
        \item \label{vl07:lemma4.25:i}
            Es ist $\phi$ genau dann unterhalbstetig, wenn $\epi(\phi)$
            abgeschlossen in $E\times\R$ (mit der Produkttopologie) ist.
            
        \item \label{vl07:lemma4.25:ii}
            Es ist $\phi$ genau dann unterhalbstetig, wenn für alle $x\in E$
            und alle $\epsilon\in\R[>0]$ eine Umgebung~$V$ von $x$ existiert, so
            dass für alle $y\in V$ gilt:
            $\phi(y)\geq\phi(x)\cdot\epsilon$.
            
        \item \label{vl07:lemma4.25:iii}
            Ist $\phi$ unterhalbstetig, so gilt für jede Folge $\nSeq x$ in $E$
            mit $\lim_{n\to\infty} x_n = x\in E$:
            \[ \liminf_{n\to\infty} \phi(x_n) \geq \phi(x) . \]
            Falls $E$ ein metrischer Raum ist, so gilt auch die Umkehrung.
            
        \item \label{vl07:lemma4.25:iv}
            Sind $\phi$ und $\tilde\phi\colon E\to\neginfinfoc$ unterhalbstetig, 
            so auch $\phi+\tilde\phi$.
            
        \item \label{vl07:lemma4.25:v}
            Ist $(\phi_i)_{i\in I}$ eine Familie unterhalbstetiger
            Abbildungen $E\to\neginfinfoc$ mit
            \[ \phi(x) = \sup_{i\in I} \phi_i(x)  \]
            für alle $x\in E$, so ist auch $\phi$ unterhalbstetig.
            
        \item \label{vl07:lemma4.25:vi}
            Ist $E\neq\emptyset$ folgenkompakt und $\phi$ unterhalbstetig, so
            nimmt die Funktion $\phi$ ihr Minimum an, d.\,h. es existiert ein
            $x_0\in E$ mit $\phi(x_0) = \inf_{x\in E} \phi(x)$.
    \end{enumerate}
\end{thLemma}

\begin{proof}
    Siehe Übungen für Teile der Aussagen. Wir beweisen hier nur
    \ref{vl07:lemma4.25:vi}:
    % "direkte Methode der Variationsrechnung"  TODO: ?
    
    Sei also $E$ folgenkompakt und nicht leer und sei $\phi$ unterhalbstetig.
    Sei dann $\nSeq x$ eine Folge in $E$, für welche
    $\bigl(\phi(x_n)\bigr)_{n\in\N}$ gegen $\inf_{x\in E} \phi(x)$ konvergiert.
    Weil $E$ folgenkompakt ist, existiert dann eine konvergente Teilfolge
    $(x_{n_k})_{k\in\N}$ und wir definieren $x_0 \defeq \lim_{k\to\infty}
    x_{n_k}$. Aus \ref{vl07:lemma4.25:iii} folgt dann:
    \[ \phi(x_0) \leq \inf_{x\in E} \phi(x) \leq \phi(x_0)  . \]
    (Dies zeigt auch, dass $\inf_{x\in E} \phi(x) > -\infty$ gelten muss.)
    \\
\end{proof}

% 4.26
\begin{thDef}
    Sei $X$ ein Vektorraum. Eine Funktion $\phi\colon X\to\neginfinfoc$ ist
    \emph{konvex}, wenn $\phi$ für alle $x,y\in X$ und alle $t\in\I$ die
    Ungleichung
    \[ \phi\bigl( tx+(1-t)\,y \bigr) \;\leq\; t\,\phi(x) + (1-t)\,\phi(y)  \]
    erfüllt. \pcref{vl07:fig:convexfunction}
    %
    \begin{figure}[b]
        \centering
        \begin{tikzpicture}
            \begin{scope}
                \draw [->,Daxis] (-3,0) -- (3,0);
                \draw [->,Daxis] (0,-0.4) -- (0,4);
                
                \begin{scope}[Dfunc, Cdarkgreen]
                    \draw (-1.5,2) parabola bend (0,0.3) (1.5,2);
                    \draw [inftyzigzag] (-3,4) node [left] {$\infty$} -- (-1.5,4);
                    \draw [inftyzigzag] (1.5,4) -- (3,4);
                \end{scope}
            \end{scope}
            
            \begin{scope}[shift={(5,0)}]
                \draw [->,Daxis] (0,0) -- (6,0);
                \draw [->,Daxis] (0,0) -- (0,4);
                
                \begin{scope}[Dfunc, Cdarkred, v/.style={out=0,in=180}]
                    \draw [inftyzigzag] (0.2,4) -- (1,4);
                    \draw (1,2) to[out=-85,in=180] (1.6,0.5) to[v] (2.1,1.1) 
                        to[v] (2.5,0.6) to[out=0,in=265] (3,2);
                    \draw [inftyzigzag] (3,4) -- (3.95,4);
                    \draw (4,2) parabola bend (4.5,1.2) (5,2);
                    \draw [inftyzigzag] (5,4) -- (5.8,4) node [right] {$\infty$};
                \end{scope}
            \end{scope}
        \end{tikzpicture}
        \caption{Konvexe Funktion links und
            \emph{nicht} konvexe Funktion rechts}
        \label{vl07:fig:convexfunction}
    \end{figure}
\end{thDef}

\pagebreak[2]
% 4.27
\begin{thLemma}
    Sei $X$ ein Vektorraum.
    \begin{enumerate}[i)]
        \item
            Es ist $\phi\colon X\to\neginfinfoc$ genau dann konvex, wenn
            $\epi(\phi)$ eine konvexe Teilmenge von $X\times\R$ ist.
        \item
            Ist $\phi\colon X\to\neginfinfoc$ konvex, so ist die Menge 
            $\{ \phi\leq\lambda \}$ für alle $\lambda\in\R$ konvex. 
            (Die Umkehrung gilt im Allgemeinen nicht.)
        \item
            Sind $\phi_1,\phi_2\colon X\to\neginfinfoc$ konvex, so auch
            $\phi_1+\phi_2$.
        \item
            Ist $(\phi_i)_{i\in I}$ eine Familie konvexer Abbildungen
            $X\to\neginfinfoc$, so ist auch 
            \[ \sup_{i\in I} \phi_i 
                \defeq \bigl(x\mapsto \sup_{i\in I} \phi_i(x)\bigr)
            \]
            konvex.
    \end{enumerate}
\end{thLemma}

Ab jetzt betrachten wir vornehmlich normierte $\R$-Vektorräume.

% 4.28
\begin{thDef}
    Sei $X$ ein normierter $\R$-Vektorraum und sei 
    $\phi\colon X\to\neginfinfoc$ eine Funktion mit $D(\phi)\neq\emptyset$
    (d.\,h. $\phi$ ist nicht konstant $\infty$).
    Dann ist die \emph{Legendre-Transformation} (oder \emph{konjugierte
    Funktion}) von $\phi$ die Abbildung
    \begin{align*}
        \phi^\ast\colon X' &\to \neginfinfoc    \\
        f &\mapsto \sup_{x\in X} \, \bigl( f(x) - \phi(x) \bigr)
    . \end{align*}
\end{thDef}

% 4.29
\begin{thBemerkung}\hfill
    \begin{enumerate}[(i)]
        \item 
            Sei $n\in\N$ und $\phi\colon\R^n\to\neginfinfoc$ eine Abbildung.
            %Garcke:
            %Dann identifizieren wir $X'$ mit $\R^n$ durch
            %\[ f(x) = x\cdot y \defeq \SP{x,y}_{\text{eukl}} \]
            %für $y\in\R^n$ geeignet.
            Ist $f\in(\R^n)'$, so gibt es genau einen Vektor $y_f\in\R^n$ mit
            $f(x) = x\cdot y \defeq \SP{x,y}_{\mr{eukl}}$ für alle $x\in\R^n$.
            Wir identifizieren dann $(\R^n)'$ mit $\R^n$ vermöge
            \begin{align*}
                (\R^n)' &\longleftrightarrow \R^n    \\
                f &\longmapsto y_f              \\
                (x\mapsto x\cdot y) &\longmapsfrom y
            \,, \end{align*}
            und somit gilt für alle $y\in\R^n$:
            \[ \phi^\ast(y) = \sup_{x\in\R^n} \bigl( x\cdot y - \phi(x) \bigr)
            . \]
            
        \item
            Es ist $\phi^\ast$ stets konvex und unterhalbstetig. Dies folgt 
            daraus, dass wir das Supremum betrachten und dass
            $f\mapsto f(x)-\phi(x)$ konvex und stetig ist (da affin linear).
            
        \item \label{vl07:bemerkung4.29:iii}
            Es gilt für alle $x\in X$ und alle $f\in X'$ die Ungleichung
            \[ f(x) \leq \phi(x) + \phi^\ast(f)     , \]
            was direkt aus der Definiton von $\phi^\ast$ folgt.
            
        \item
            Die Youngsche Ungleichung \pcref{vl03:young}
            ist ein Spezialfall von \ref{vl07:bemerkung4.29:iii}.
            Seien $p,p'\in(1,\infty)$ mit $\frac{1}{p}+\frac{1}{p'}=1$ und setze
            $\phi(x) \defeq \frac{1}{p} \, \abs{x}^p  . $
            Dann gilt für alle $y\in\R[\geq0]$:
            \[ \phi^\ast(y) = \frac{1}{\mkern3mu p'} \, \abs{y}^{p'}  . \]
            (Siehe Übungen.)
    \end{enumerate}
\end{thBemerkung}

% 4.30
\begin{thTheorem} \label{vl07:theorem4.30}
    Sei $X$ ein normierter $\R$-Vektorraum und $\phi\colon X\to\neginfinfoc$
    konvex und unterhalbstetig mit $D(\phi)\neq\emptyset$. Dann gilt
    $D(\phi^\ast)\neq\emptyset$ und $\phi$ ist von unten durch eine affin
    lineare Funktion beschränkt.
\end{thTheorem}

\begin{proof}
%
\begin{figure}
    \centering
    \begin{tikzpicture}
        \draw [->,Daxis] (-1,0) -- (8,0) node [right] {$X$};
        \draw [->,Daxis] (0,-1) -- (0,4) node [left] {$\R$};
        
        \filldraw [fill=black!30, path fading=north, Dfunc, name path=phi]
            (1,4) parabola bend (4,2) (7,4);
        \draw [Cdarkgreen, Dfunc] (-0.3,-1) -- (20:8) 
            node [below right] {$H$};
        
        \path (4,3) node {$A=\epi(\phi)$};
        
        \coordinate (lambda0) at (0,1);
        \coordinate (x0) at (6,0);
        \path [name path=helpline] (x0) -- +(0,4);
        
        \path (lambda0)++(x0) node [Dpoint] {};
        \draw (lambda0) +(2pt,0) -- +(-4.5pt,0) node [left] {$\lambda_0$};
        \draw (x0) +(0,2pt) -- +(0,-5.5pt) node [below] {$x_0$};
        \path [name intersections={%
                    of=helpline and phi, sort by=helpline, by={x0phix0}}
                ] (0,0 |- x0phix0) coordinate (phix0);
        \draw (phix0) +(2pt,0) -- +(-4.5pt,0) node [left] {$\phi(x_0)$};
    \end{tikzpicture}
    \caption{Skizze zum Beweis von \cref{vl07:theorem4.30}}
    \label{vl07:fig:theorem4.30}
\end{figure}
%
    Sei $x_0\in D(\phi)$ und sei $\lambda_0\in\R$ mit $\lambda_0 < \phi(x_0)$.
    Wende nun die zweite geometrische Form des Satzes von Hahn-Banach
    \pref{vl06:hahnbanachgeom2} auf den Raum $X\times\R$, die abgeschlossene
    Menge $A\defeq \epi(\phi)$ und die kompakte Menge $B\defeq
    \{(x_0,\lambda_0)\}$ an. \pcref{vl07:fig:theorem4.30}
    %%% 07-11-2013 %%%
    Wir erhalten somit ein stetiges lineares Funktional $\Phi\colon
    X\times\R\to\R$ und ein $\alpha\in\R$, so dass die abgeschlossene Hyperebene
    $H=\{ \Phi = \alpha \} \subset X\times\R$ die Mengen $A$ und $B$ trennt.  Die
    Abbildung
    \begin{align*}
        f\colon X &\to \R   \\
        x &\mapsto \Phi\bigl( (x,0) \bigr)
    \end{align*}
    ist stetig und es gilt $f\in X'$. Mit $k \defeq \Phi\bigl( (0,1) \bigr)$
    gilt für alle $(x,\lambda)\in X\times\R$
    \[ \Phi\bigl( (x,\lambda) \bigr) = f(x) + k\lambda  . \]
    Es gilt weiter $\Phi\vert_A > \alpha$ und $\Phi\vert_B < \alpha$. Dann gilt 
    also $f(x_0) + k\lambda_0 < \alpha$ und
    \[ f(x) + k\lambda > \alpha   \]
    für alle $(x,\lambda)\in\epi(\phi)$.
    Somit erhalten wir für alle $x\in D(\phi)$:
    \[ \tag{$\star$} \label{vl07:star}
        f(x) + k\phi(x) > \alpha
    \]
    und für den Punkt $(x_0,\lambda_0)$:
    \[ f(x_0)+k\phi(x_0) > \alpha > f(x_0) + k\lambda_0  . \]
    Dies zeigt $k>0$ (da $\phi(x_0) > \lambda_0$ nach Wahl von $\lambda_0$). Aus \eqref{vl07:star}
    folgt, dass für alle $x\in D(\phi)$ gilt:
    \[ -\frac{1}{k}\,f(x) - \phi(x) < - \frac{\alpha}{k}  . \]
    Daraus folgt $\phi^\ast\bigl( -\frac{1}{k} f \bigr) < \infty$ (nach Definition
    von $\phi^\ast$) und damit
    \[ \phi(x) > -\frac{1}{k}\,f(x) + \frac{\alpha}{k}  , \]
    aber gerade das wollten wir zeigen.
    \\
\end{proof}
